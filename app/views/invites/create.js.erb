<% if @status == :first %> 
  <% publish_to "/users/#{@user.id}" do %>
    $("#invites").prepend("<%= j render 'invites/invite', invite: @invite %>");
    var invite_count = $("span#invite_count")

    if (invite_count.text() === "0") {
      invite_count.addClass("badge-important");
    }

    invite_count.text(Number(invite_count.text())+1);
  <% end %>

  <% publish_to "/attempts/#{@attempt.id}" do %>
    <% @puzzle = @attempt.puzzle %>
    $("#stream").prepend("<p><%=@message%></P>")
    // Right now, you could possibly invite someone back and see the score twice. Bug
    $(".versus-scores").append("<%= j render 'attempts/modes/player_score', {user: @user} %>");
  <% end %>

<% elsif @status == :repeat %>
  <% publish_to "/users/#{@user.id}" do %>
    if ($("span#invite_count").text() === "0") {
      $("span#invite_count").addClass("badge-important");
    }
  <% end %>

  <% publish_to "/attempts/#{@attempt.id}" do %>
    $("#stream").prepend("<p><%=@warning%></P>")
  <% end %>
<% elsif @status == :limit %>
  <% publish_to "/attempts/#{@attempt.id}" do %>
    $("#stream").prepend("<p><%=@warning%></P>")
  <% end %>

<% else %>
  $("#stream").prepend("<P>That player does not exist!</P>");
<% end %>

$("#friend").val("");